<!DOCTYPE html>
<head>
   <meta charset="utf-8">
   <meta name="description" content="MammalNet (2018-06)">
   <meta name="author" content="Mark Thomas">
   <title>DCLDE 2018 - MammalNet</title>
   <link rel="shortcut icon" href="favicon.ico" />

   <!-- Core and extension CSS files -->
   <link rel="stylesheet" media="screen" href="core/deck.core.css">
   <link rel="stylesheet" media="screen" href="extensions/goto/deck.goto.css">
   <link rel="stylesheet" media="screen" href="extensions/menu/deck.menu.css">
   <link rel="stylesheet" media="screen" href="extensions/status/deck.status.css">
   <link rel="stylesheet" media="screen" href="extensions/scale/deck.scale.css">
   <link rel="stylesheet" media="screen" href="style.css">
   <link rel="stylesheet" media="screen" href="transition/horizontal-slide.css">
   <link rel="stylesheet" media="print" href="core/print.css">

   <!-- JavaScript -->
   <script src="vendor/jquery.min.js"></script>
   <script src="vendor/modernizr.custom.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.2.2/d3.min.js"></script>
</head>
<body>
   <div class="deck-container">
      <!-- TITLE PAGE -->
      <section class="slide" id="title">
         <p>
            <span style="font-weight: 500">
               8<sup style="font-size: .6em">th</sup> DCLDE Workshop
            </span>
            <br />
            <span style="font-size: .8em">
               Paris, France, 4-8 June 2018
            </span>
         </p>
         <h1>
            MammalNet <br />
            <span style="color: #ef8376; font-size: .75em; font-style: italic; font-weight: 400">
               Marine mammal species classification using Convolutional Neural Networks
            </span>
         </h1>
         <div id="title-author">
            <p>
               <span style="font-weight: 300">
                  <strong style="font-weight: 600">Mark Thomas</strong><sup style="font-style: italic; font-size: .66em">1,2</sup>,
                  Bruce Martin<sup style="font-style: italic; font-size: .66em">1,3</sup>
                   & Stan Matwin<sup style="font-style: italic; font-size: .66em">2</sup>
               </span>
            </p>
            <p style="font-size: .66em; font-style: italic; font-weight: 300">
               <sup>1 </sup>JASCO Applied Sciences, Dartmouth, Nova Scotia, Canada<br style="margin-bottom: .5em" />
               <sup>2 </sup>Dalhousie University, Department of Computer Science <br style="margin-bottom: .5em" />
               <sup>3 </sup>Dalhousie University, Department of Oceanography
            </p>
         </div>
      </section>

      <!-- OUTLINE -->
      <section class="slide" id="talk-outline">
         <h2>Presentation outline</h2>
         <ul>
            <li>What is the problem we're trying to address?</li>
         </ul>
         <p class="slide" align="center" style="width: 67%; margin: 0 auto; font-style:italic">
            Marine mammal species classification
         </p>
         <br />
         <ul>
            <li>Proposed methodology</li>
         </ul>
         <p class="slide" align="center" style="width: 67%; margin: 0 auto; font-style:italic">
            Deep Convolutional Neural Networks
         </p>
         <br />
         <ul>
            <li>Current experimental results</li>
         </ul>
         <p class="slide" align="center" style="width: 67%; margin: 0 auto; font-style:italic">
            Training details, plots, and tables.
         </p>
      </section>

      <!-- PROBLEM DEFINITION -->
      <section class="slide no-header" id="species-classification">
         <h2>Marine mammal species classification</h2>
         <p>
            Provided a large corpus of annotated spectrograms of mammal vocalizations and their corresponding species label.
         </p>
         <div class="slide">
            <img width="650" src="media/images/pamlab.png"/>
         </div>
      </section>

      <!-- DATASET -->
      <section class="slide" id="dataset">
         <h2>Dataset</h2>
         <div id="right-side" style="width: 33%">
            <br /><br />
            <ul>
               <li class="slide">Large dataset
                  <div class="small-comment" style="font-size: 0.667em">(&#8776; 450,000 instances)</div>
               </li>
               <li class="slide">Human annotated spectrograms of marine mammal vocalizations</li>
               <li class="slide">Zero-padded to meet a pre-specified dimension</li>
               <li class="slide">Training, validation, and test split</li>
            </ul>
            <p style="text-align: center" class="slide small-comment">image sources: animalspot.net, govt.nz, soundrolling.com, thelocal.dk, whales.org, wikipedia.org & worldwildlife.org </p>
         </div>
         <div id="left-side">
            <div id="bubblechart"></div>
            <script type='text/javascript'>
               function drawBubbles() {
                  // Define the height and width of the SVG
                  var parent = d3.select('div.bubbleparent');
                  var width = 600,
                     height = 600;

                  // Define the center of the SVG
                  var center = {
                     x: width / 2,
                     y: height / 2
                  };

                  // Select the div to plot the SVG
                  var svg = d3.select("#bubblechart")
                     .append("svg")
                     .attr("height", height)
                     .attr("width", width)
                     .append("g");

                  // Initialize the svg definitions and other D3 parameters
                  var defs = svg.append("defs");

                  var radiusScale = d3.scalePow().domain([1, 1]).exponent(0.5).range([1, 100]);
                  var forceStrength = 0.03;

                  // Define the force simulation
                  var simulation = d3.forceSimulation()
                     .velocityDecay(0.2)
                     .force("x", d3.forceX().strength(forceStrength).x(center.x))
                     .force("y", d3.forceY().strength(forceStrength).y(center.y))
                     .force("collide", d3.forceCollide(function(d) {
                        return radiusScale(d.pic_size) + 1
                     }))

                  // read the data and await calling of the 'ready' function
                  d3.queue().defer(d3.csv, "mammals.csv").await(ready);

                  //
                  function ready(error, data) {
                     var maxAmount = d3.max(data, function(d) {
                        return +d.pic_size;
                     });
                     radiusScale.domain([0, maxAmount]);

                     defs.selectAll(".mammal-pattern")
                        .data(data)
                        .enter().append("pattern")
                        .attr("class", "mammal-pattern")
                        .attr("id", function(d) {
                           return 'mammal_' + d.id
                        })
                        .attr("height", "100%")
                        .attr("width", "100%")
                        .attr("patternContentUnits", "objectBoundingBox")
                        .append("image")
                        .attr("height", 1)
                        .attr("width", 1)
                        .attr("preserveAspectRatio", "none")
                        .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
                        .attr("xlink:href", function(d) {
                           return d.pic
                        });

                     var circles = svg.selectAll(".mammal")
                        .data(data)
                        .enter().append("circle")
                        .attr("class", "mammal")
                        .attr("r", function(d) {
                           return radiusScale(d.pic_size)
                        })
                        .attr("stroke", '#ef8376')
                        .attr("stroke-width", "4")
                        .attr("fill", function(d) {
                           return 'url(#mammal_' + d.id + ')'
                        })
                        .attr('fill-opacity', '.8')
                        .on('mouseover', showDetail)
                        .on('mouseout', hideDetail);

                     // define the moseover function
                     function showDetail(d) {
                        d3.select(this)
                           .attr('stroke-width', '8')
                           .attr('fill-opacity', '1')
                           .append('svg:title')
                           .text(function(d) {
                              return d.name;
                           });
                     }

                     // define the mouseout function
                     function hideDetail(d) {
                        d3.select(this)
                           .attr('stroke-width', '4')
                           .attr('fill-opacity', '.8');
                     }


                     // helper function for the simulation
                     function ticked() {
                        circles.attr("cx", function(d) {
                              return d.x
                           })
                           .attr("cy", function(d) {
                              return d.y
                           })
                     }

                     // run the simulation
                     simulation.nodes(data).on('tick', ticked);
                  }
               }
               drawBubbles();
            </script>
         </div>
      </section>

      <!-- CTA -->
      <section class="slide" id="uh-oh-problem">
         <br /><br /><br /><br />
         <p align="center">
            There is just one problem...
         </p>
         <br />
         <div class="slide">
            <p align="center">
               I'm a computer scientist<sup>*</sup> &#128104;&#8205;&#128187; &#128517;
            </p><br /><br /><br /><br /><br /><br /><br />
            <div class="small-comment" style="text-align: right; font-size: 0.667em; padding-right: 5em">
               <p style="font-style:italic; font-size: 0.667em">
                  <span style="font-size: 1.75em">*</span> so not really a scientist?
               </p>
            </div>
         </div>
      </section>

      <!-- METHODOLOGY -->
      <section class="slide" id="proposed-methodology">
         <h2>Proposed Methodology</h2>
         <br />
         <p class="slide" style="text-align: center">
            Can I naïvely think of these spectrogram annotations as greyscale images?
         </p>
         <br />
         <p class="slide" style="text-align: center">
            Can I treat this as an image classification problem and use a ConvNet?
         </p>
      </section>

      <!-- CONVNET ARCHITECTURE -->
      <section class="slide" id="network-architecture-1">
         <h2>Network Architecture (1)</h2>
         <p>MammalNet: deep CNN inspired by the classic LeNet architecture <a href=#list-of-references>[1]</a></p>
         <img src="media/images/cnn.png" />
         <ol class="layers">
            <li class="slide">32 5x5x1 convolution kernels &rarr; 2x downsampling via max-pooling</li>
            <li class="slide">64 5x5x32 convolution kernels &rarr; 2x downsampling via max-pooling</li>
            <li class="slide">64 5x5x64 convolution kernels &rarr; 2x downsampling via max-pooling</li>
            <li class="slide">Flattening &rarr; Fully-connected layer of length 2048</li>
            <li class="slide">Fully-connected layer of length 1024</li>
            <li class="slide">Output layer for the possible 11 classes</li>
         </ol>
      </section>
      <section class="slide" id="network-architecture-2">
         <h2>Network Architecture (2)</h2>
         <p>Further details...</p>
         <ul class="layers">
            <li class="slide">ReLU activations for layers 1-5</li>
            <li class="slide">Batch-normalization and dropout regularization</li>
            <li class="slide">Categorical cross-entropy loss function</li>
            <li class="slide">Exponential learning-rate weight decay</li>
            <li class="slide">Adam optimizer <a href=#list-of-references>[2]</a></li>
            <li class="slide">Roughly 172M parameters</li>
            <li class="slide">Implemented using Tensorflow <a href=#list-of-references>[3]</a></li>
         </ul>
      </section>

      <!-- TRAINING DETAILS -->
      <section class="slide" id="model-training">
         <h2>Training the ConvNet</h2>
         <p>Some details on training such a large model:</p>
         <div class="slide" style="padding: .5em 0">
            <img width="500" src="media/images/need_a_gpu.jpg"/>
         </div>
         <ul>
            <li class="slide">Trained on Compute Canada using an NVIDIA Tesla P100 GPU</li>
            <li class="slide">100 epochs per training run using minibatches of size 64</li>
            <li class="slide">Training time &#8776;10hrs</li>
         </ul>
      </section>

      <!-- RESULTS -->
      <section class="slide" id="results-1">
         <h2>Experimental Results (1)</h2>
         <img width="1200" src="media/images/cross_entropy.png"/>
      </section>
      <section class="slide" id="results-2">
         <h2>Experimental Results (2)</h2>
         <img width="1200" src="media/images/accuracy.png"/>
      </section>
      <section class="slide" id="results-3">
         <h2>Experimental Results (3)</h2>
         <img width="1200" src="media/images/confusion_matrix.png"/>
      </section>

      <!-- FUTURE WORK -->
      <section class="slide" id="future-work-1">
         <h2>Future Work (1)</h2>
         <p>Advances in image recognition led to further advances in object detection!</p>
         <p>Can we apply the same deep learning techniques here? (e.g.: Sermanet et al. 2013 <a href=#list-of-references>[4]</a>, Redmon et al. 2016 <a href=#list-of-references>[5]</a>)</p>
         <div class="slide">
            <img width="800" src="media/images/object_detection.png"/>
         </div>
      </section>
      <section class="slide" id="future-work-2">
         <h2>Future Work (2)</h2>
         <p>Provided <span style="color: #ef8376; font-weight: 600; font-style: bold">Future Work (1)</span> is feasible...</p>
         <div class="slide">
            <p>Deployment to a real-time agent (e.g.: autonomous gliders)</p>
            <br />
            <img width="500" src="media/images/glider.jpg"/>
            <br />
            <p style="text-align: center" class="small-comment">image source: teledynemarine.com</p>
         </div>
      </section>

      <!-- THANK YOU PAGE -->
      <section class="slide" id="the-end">
         <div class="slide-content">
            <h1 align="center">Thank you for listening!</h1>
            <br /><br /><br /><br /><br />
            <table align="center">
                <tr>
                    <td style="padding:0 25px 0 25px;"><img height="80" src="media/images/bigdatalogo.png"/></td>
                    <td style="padding:0 25px 0 25px;"><img height="80" src="media/images/jascologo.png"/></td>
                    <td style="padding:0 25px 0 25px;"><img height="80" src="media/images/nserclogo.jpg"/></td>
                    <td style="padding:0 25px 0 25px;"><img height="80" src="media/images/cclogo.png"/></td>
                </tr>
            </table>

         </div>
      </section>

      <!-- REFERENCES -->
      <section class="slide" id="list-of-references">
         <h2>References</h2>
         <div id="references">
            <div id="ref-title">[1] Gradient-based learning applied to document recognition.</div>
            <div id="ref-author">Y. LeCun, L. Bottou, Y. Bengio, and P. Haffner.</div>
            <div id="ref-journal">Proceedings of the IEEE, 86(11):2278-2324, 1998.</div>

            <div id="ref-title">[2] Adam: A method for stochastic optimization.</div>
            <div id="ref-author">D. P. Kingma, and J. Ba.</div>
            <div id="ref-journal">arXiv preprint, arXiv:1412.6980, 2014.</div>

            <div id="ref-title">[3] TensorFlow: Large-Scale Machine Learning on Heterogeneous Systems.</div>
            <div id="ref-author">M. Abadi, A. Agarwal, P. Barham, E. Brevdo, Z. Chen, C. Citro, G. S. Corrado, A. Davis, J. Dean, M. Devin, S. Ghemawat, I. Goodfellow, A. Harp, G. Irving, M. Isard, Y. Jia, R. Jozefowicz, L. Kaiser, M. Kudlur, J. Levenberg, D. Mané, R. Monga, S. Moore, D. Murray, C. Olah, M. Schuster, J. Shlens, B. Steiner, I. Sutskever, K. Talwar, P. Tucker, V. Vanhoucke, V. Vasudevan, F. Viégas, O. Vinyals, P. Warden, M. Wattenberg, M. Wicke, Y. Yu, and X. Zheng.</div>
            <div id="ref-journal">https://www.tensorflow.org, Software available from tensorflow.org, 2015.</div>

            <div id="ref-title">[4] Overfeat: Integrated recognition, localization and detection using convolutional networks.</div>
            <div id="ref-author">P. Sermanet, D. Eigen, X. Zhang, M. Mathieu, R. Fergus, and Y. LeCun.</div>
            <div id="ref-journal">arXiv preprint, arXiv:1312.6229, 2013.</div>

            <div id="ref-title">[5] You only look once: Unified, real-time object detection.</div>
            <div id="ref-author">J. Redmon, S. Divvala, R. Girshick, and A. Farhadi.</div>
            <div id="ref-journal">Proceedings of the IEEE conference on computer vision and pattern recognition, 779-788. 2016.</div>
         </div>
      </section>
   </div>

   <!-- Load resources -->
   <script src="core/deck.core.js"></script>
   <script src="extensions/menu/deck.menu.js"></script>
   <script src="extensions/goto/deck.goto.js"></script>
   <script src="extensions/status/deck.status.js"></script>
   <script src="extensions/scale/deck.scale.js"></script>

   <!-- Initialize the deck -->
   <script>
      $(function() {
         $.deck('.slide');
      });
   </script>
</body>
</html>
