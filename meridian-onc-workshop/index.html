<!DOCTYPE html>

<head>
   <meta charset="utf-8">
   <meta name="description" content="MammalNet (2018-06)">
   <meta name="author" content="Mark Thomas">
   <title>MERIDIAN/ONC Workshop</title>
   <link rel="shortcut icon" href="favicon.ico" />

   <!-- CSS -->
   <link rel="stylesheet" media="screen" href="core/deck.core.css">
   <link rel="stylesheet" media="screen" href="extensions/goto/deck.goto.css">
   <link rel="stylesheet" media="screen" href="extensions/menu/deck.menu.css">
   <link rel="stylesheet" media="screen" href="extensions/status/deck.status.css">
   <link rel="stylesheet" media="screen" href="extensions/scale/deck.scale.css">
   <link rel="stylesheet" media="screen" href="style.css">
   <link rel="stylesheet" media="screen" href="transition/fade.css">
   <link rel="stylesheet" media="print" href="core/print.css">

   <!-- JavaScript -->
   <script src="vendor/jquery.min.js"></script>
   <script src="vendor/modernizr.custom.js"></script>
   <script defer src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/js/all.js" crossorigin="anonymous"></script>
</head>

<body>

   <!-- Open the deck-container -->
   <div class="deck-container">

      <!-- Status -->
      <p class="deck-status">
         <span class="deck-status-current"></span> of <span class="deck-status-total"></span>
      </p>

      <!-- Title -->
      <section class="slide" id="title">
         <p id="sup-title">MERIDIAN Workshop &mdash; Victoria, BC &mdash; November 21, 2019</p>
         <h1>
            Detecting endangered baleen whales within acoustic recordings using R-CNNs<span style="font-size: 0.4em;">, and how I got here...</span>
         </h1>
         <div id="title-credit">
            <p id="title-author">
               Mark Thomas
            </p>
            <p id="title-inst">
               Dalhousie University & JASCO Applied Sciences
            <p>
         </div>
      </section>

      <!-- Background -->
      <section class="slide" id="background-1">
         <h2>Some background...</h2>
         <div class="slide" id="background-2" style="margin-top: 0">
            <p style="float: left; margin-top: 0;"><i class="far fa-envelope-open"></i></p>
            <img style="width: 500px; float: left; margin: auto 25px; border-radius: 10px;" src="media/images/email_from_bruce.png" />
            <p>
               In late 2017/early 2018 I started working for JASCO on a <span id="to-comment-out">detection and</span> classification algorithm.
            </p>
         </div>
         <div class="slide" id="background-3">
            <script type="text/javascript">
               $("#background-3").bind('deck.becameCurrent', function(ev, direction) {
                  var t = document.getElementById("to-comment-out");
                  if(direction == "forward"){
                     t.classList.add("strike-through");
                  }
                  else{
                     t.classList.remove("strike-through");
                  }
               });
            </script>
         </div>
         <br />
         <div class="slide" id="background-4">
            <br style="width: 100%"/><br style="width: 100%"/><br style="width: 100%"/>
            <h5 style="margin-bottom: 0;">MammalNet:</h5>
            <ul style="margin-top: .25em;">
               <li>no detection involved &#8594; classify vocalizations to different species using pre-extracted contours</li>
               <li>eleven classes: beluga, blue, bowhead, fin, humpback, minke, right, and sei whales + walruses & bearded seals</li>
               <li>shallow ConvNet developed in Tensorflow: 3 convolutional layers + 2 fully connected layers</li>
            </ul>
         </div>
         <p class="slide" id="background-5" style="text-align: center; padding-top: 1em;" >
            &#128564;&nbsp; OK results, but can we cut out the contour detector?
         </p>
      </section>

      <section class="slide" id="background-cont-1">
         <h2 class="section-continued">... some (continued) background</h2>
         <h5 style="margin-bottom: 0;">MammalNet v2: more net, fewer mammals</h5>
         <div class="slide" id="background-cont-2">
            <ul style="margin-top: 0.5em;">
               <li>trained on spectrograms instead of extracted contours</li>
               <li>to do more we need to turn it down from 11</li>
               <li>
                  fewer species: blue, fin, and sei whales + non-biological noise & ambient noise examples
                  <br /><img style="width: 80%; padding: 2em 0 1em 0;" src="media/images/species_grid_WIDE.png" />
               </li>
            </ul>
         </div>
         <div class="slide" id="background-cont-3">
            <ul style="margin-top: -0.5em;">
               <li>
                  deeper nets: <span id="vgg-deep">VGG-19</span> and <span id="resnet-deep">ResNet-50</span> implemented in PyTorch
               </li>
               <li>detection can be accomplished by sliding the classifier over a sequence of spectrograms</li>
               <li>great performance! <span class="small-comment">turns out: reducing your # of classes will have this affect</span></li>
            </ul>
         </div>
         <p class="slide" id="background-cont-4" style="text-align: center; padding-top: 1em;" >
            &#129300;&nbsp; is this really doing "detection"?
         </p>
         <div style="position: relative; width: 100%; bottom: -5%; margin-top: 25px">
            <p style="text-align: center; font-size: 0.5em; width: 100%; position: absolute;">
               Simonyan et al. "Very deep convolutional networks for large-scale image recognition." ICLR 2015 <br />
               He et al. "Deep residual learning for image recognition." CVPR 2016
            </p>
         </div>
      </section>

      <!-- MammalNet v3 -->
      <section class="slide" id="methodology-1">
         <h2>MammalNet v3: triple the v's, triple the nets</h2>
         <div class="slide" id="methodology-2">
            <ul style="margin-top: 0.5em;">
               <li>
                  there have been huge advancements to the SOTA in object detection and semantic/instance segmentation:
               </li>
            </ul>
            <div class="row">
               <div class="column-33" style="margin: auto;">
                  <img style="width: 66.7%; float: right; margin-top: 5%; border-radius: 10px" src="media/images/yolo_paper.png"/>
               </div>
               <div class="column-33">
                  <img style="width: 90%; border-radius: 10px" src="media/images/mask_rcnn_paper.png"/>
               </div>
               <div class="column-33">
                  <img style="width: 66.7%; float: left; margin-top: 5%; border-radius: 10px" src="media/images/faster_rcnn_paper.png"/>
               </div>
            </div>
         </div>

         <div class="slide" id="methodology-3">
            <ul>
               <li>
                  in the frequency domain, marine mammal vocalization detection is more or less the same task!
               </li>
               <li>
                  for v2 we had full bounding box annotations, but we only used the start/end times
               </li>
               <li>
                  the underlying (neural net) architecture of v3 is a region-based ConvNet
               </li>
            </ul>
         </div>

         <div style="position: relative; width: 100%; bottom: -5%; margin-top: 150px">
            <p style="text-align: center; font-size: 0.5em; width: 100%; position: absolute;">
               screenshots taken from arXiv.org <br />
               Redmon et al. "You only look once: Unified, real-time object detection." CVPR 2016 <br />
               He et al. "Mask r-cnn." ICCV 2017 <br />
               Ren et al. "Faster r-cnn: Towards real-time object detection with region proposal networks." NeurIPS 2015
            </p>
         </div>
      </section>

      <section class="slide" id="rcnns">
         <h2>Region-based ConvNets</h2>
         <ul>
            <li>
               some history:
               <span class="slide" id="rcnns-1"><span id="underline-1">"R-CNN"</span></span>
               <span class="slide" id="rcnns-2">  &#8594;  <span id="underline-2">"Fast R-CNN"</span></span>
               <span class="slide" id="rcnns-3">  &#8594;  <span id="underline-3">"Faster R-CNN"</span></span>
               <span class="slide" id="rcnns-4">  &#8594;  <span id="underline-4">"Mask R-CNN"</span></span>
            </li>
         </ul>
         <div id="rcnn-history-text" style="width: 90%; height: 400px; border: 1px solid black; border-radius: 5px; margin-left: 5%">
            <!-- JavaScript changes the contents of this box -->
         </div>
         <div style="position: relative; width: 100%; bottom: -5%; margin-top: 300px">
            <p style="text-align: center; font-size: 0.5em; width: 100%; position: absolute;">
               Girshick et al. "Rich feature hierarchies for accurate object detection and semantic segmentation." CVPR 2014 <br />
               Girshick "Fast r-cnn." ICCV 2015
            </p>
         </div>

         <script type="text/javascript">
            $("#rcnns-1").bind('deck.becameCurrent', function(ev, direction) {
               var t = document.getElementById("underline-1");
                   d = document.getElementById("rcnn-history-text");
               if(direction == "forward"){
                  t.classList.add("add-underline");
                  d.innerHTML = `
                     <p style="margin: 25px 25px 0 25px">good...</p>
                     <ul class="good-before" style="margin: 0 25px">
                        <li>uses region-proposals: find regions in the image likely to contain object</li>
                        <li>run warped versions of these RoIs through the ConvNet</li>
                     </ul>
                     <p style="margin: 25px 25px 0 25px">bad...</p>
                     <ul class="bad-before" style="margin: 0 25px">
                        <li>two-stage learning: first classify, then do regression on the bounding boxes</li>
                        <li>slow to train and to test</li>
                     </ul>
                  `;
               }
               else{
                  t.classList.remove("add-underline");
                  d.innerHTML = ``;
               }
            });
         </script>

         <script type="text/javascript">
            $("#rcnns-2").bind('deck.becameCurrent', function(ev, direction) {
               var t0 = document.getElementById("underline-1");
                   t1 = document.getElementById("underline-2");
                    d = document.getElementById("rcnn-history-text");

               if(direction == "forward"){
                  t1.classList.add("add-underline");
                  t0.classList.remove("add-underline");
                  d.innerHTML = `
                     <p style="margin: 25px 25px 0 25px">good...</p>
                     <ul class="good-before" style="margin: 0 25px">
                        <li>do the convolutions first: RoIs share the same feature maps</li>
                        <li>introduced "RoIPool" for changing the dimensions of the RoIs</li>
                        <li>huge speed up during training/inference</li>
                        <li>multi-task learning: both classification and regression at the same time</li>
                     </ul>
                     <p style="margin: 25px 25px 0 25px">bad...</p>
                     <ul class="bad-before" style="margin: 0 25px">
                        <li>inference speed is bottlenecked by the RoI algorithm</li>
                     </ul>
                  `;
               }
               else{
                  t0.classList.add("add-underline");
                  t1.classList.remove("add-underline");
                  d.innerHTML = ``;
               }
            });
         </script>

         <script type="text/javascript">
            $("#rcnns-3").bind('deck.becameCurrent', function(ev, direction) {
               var t0 = document.getElementById("underline-2");
                   t1 = document.getElementById("underline-3");
                    d = document.getElementById("rcnn-history-text");
               if(direction == "forward"){
                  t1.classList.add("add-underline");
                  t0.classList.remove("add-underline");
                  d.innerHTML = `
                     <p style="margin: 25px 25px 0 25px">good...</p>
                     <ul class="good-before" style="margin: 0 25px">
                        <li>retains all the benefits of Fast R-CNN</li>
                        <li>learn the RoIs: "region proposal network" (RPN)</li>
                     </ul>
                     <p style="margin: 25px 25px 0 25px">debatable...</p>
                     <ul class="meh-before" style="margin: 0 25px">
                        <li>now we actually have four losses (+= 2 from the RPN)</li>
                     </ul>
                  `;
               }
               else{
                  t0.classList.add("add-underline");
                  t1.classList.remove("add-underline");
                  d.innerHTML = ``;
               }
            });
         </script>

         <script type="text/javascript">
            $("#rcnns-4").bind('deck.becameCurrent', function(ev, direction) {
               var t0 = document.getElementById("underline-3");
                   t1 = document.getElementById("underline-4");
                    d = document.getElementById("rcnn-history-text");
               if(direction == "forward"){
                  t1.classList.add("add-underline");
                  t0.classList.remove("add-underline");
                  d.innerHTML = `
                     <p style="margin: 25px 25px 0 25px">good...</p>
                     <ul class="good-before" style="margin: 0 25px">
                        <li>retains all the benefits of Fast/er R-CNN</li>
                        <li>can learn masks on top of bounding boxes</li>
                        <li>introduced "RoIAlign" which outperforms RoIPool</li>
                     </ul>
                     <p style="margin: 25px 25px 0 25px">debatable...</p>
                     <ul class="meh-before" style="margin: 0 25px">
                        <li>we have an additional loss function for the mask</li>
                     </ul>
                  `;
               }
               else{
                  t0.classList.add("add-underline");
                  t1.classList.remove("add-underline");
                  d.innerHTML = ``;
               }
            });
         </script>
      </section>

      <section class="slide" id="mask-rcnn">
         <h2>Mask R-CNN</h2>
         <ul>
            <li>part of the R-CNN family</li>
            <li>the SOTA for many tasks: object detection, semantic segmentation, instance segmentation</li>
            <li>composed of three nets</li>
         </ul>
         <div class="row" style="padding-top: .5em; font-size: 0.9em;">
            <div class="slide" id="methodology-cont-2">
               <div class="column-5">&nbsp;</div>
               <div class="column-30" style="border: 1px solid black; border-radius: 5px; margin-top: .25em;">
                  <h5 style="text-align: center; margin-top: 1em; margin-bottom: 0; text-decoration: underline;">
                     1. the feature extraction net
                  </h5>
                  <ul style="margin: 25px">
                     <li>a.k.a the "backbone"</li>
                     <li>used for extracting meaningful features from your input</li>
                     <li>users choice: ResNet, ResNeXt, VGG, MobileNet...</li>
                     <li>we use: ResNet-50 and then a feature pyramid network</li>
                  </ul>
               </div>
            </div>

            <div class="slide" id="methodology-cont-3">
               <div class="column-5">
                  <p style="text-align: center; font-size: 1.5em; margin-top: 4em;">&nbsp;</p>
               </div>
               <div class="column-30"  style="border: 1px solid black; border-radius: 5px;">
                  <h5 style="text-align: center; margin-top: 1em; margin-bottom: 0; text-decoration: underline;">
                     2. the region proposal net
                  </h5>
                  <ul style="margin: 25px">
                     <li>a second learned net</li>
                     <li>as the name suggests: proposes regions of interest (RoIs) directly from the feature maps of the backbone</li>
                     <li>RoIAlign: pooling method w/o quantization s.t. RoIs have the same size</li>
                  </ul>
               </div>
            </div>

            <div class="slide" id="methodology-cont-4">
               <div class="column-5">
                  <p style="text-align: center; font-size: 1.5em; margin-top: 4em;">&nbsp;</p>
               </div>
               <div class="column-30"  style="border: 1px solid black; border-radius: 5px; margin-top: 1em;">
                  <h5 style="text-align: center; margin-top: 1em; margin-bottom: 0; text-decoration: underline;">
                     3. the head net
                  </h5>
                  <ul style="margin: 25px">
                     <li>a third learned net</li>
                     <li>provided the RoIs, computes a multi-task loss</li>
                     <li>classification score (softmax loss) and bounding box regression (L1-loss)</li>
                  </ul>
               </div>
            </div>
         </div>
      </section>

      <section class="slide no-header" id="mask-rcnn-cont-1">
         <h2 class="section-continued">... Mask R-CNN</h2>
         <br /><br />
         <!-- <img src="media/images/network_design_3.png" style="width: 90%"/> -->
         <div class="row">
            <div class="column-20">
               <img src="media/images/wave_plot.png" width="200px" style="margin: 0 auto; padding: 0; float: left; margin-left: 1em;"/>
            </div>
         </div>
         <div class="row">
            <img src="media/images/spectrogram_plot.png" width="200px" style="float: left; margin-right: 50px; margin-left: 1em;"/>
            <img src="media/images/network_design_2.png" style="border: 2px solid black; padding: 25px; border-radius: 10px; width: 1000px; float: left; margin-right: 20px; margin-top: -.5em;"/>
            <img src="media/images/predictions_plot.png" width="230px" style="float: left;"/>
         </div>
      </section>

      <!-- Acoustic Recordings -->
      <section class="slide" id="recordings">
         <h2>Acoustic recordings</h2>
         <div class="row">
            <div class="column-40" style="margin: auto;">
               <img style="width: 90%; float: left; margin-top: 0.5em; border-radius: 10px;" src="media/images/deployment_map.png"/>
            </div>
            <div class="column-60" style="margin-top: 0.5em;">
               <ul>
                  <li>very large collection of recordings off the coast of Atlantic Canada (Scotian Shelf)</li>
                  <li>20 stations in total that were sampled at 8kHz and 250kHz</li>
                  <li>deployments took place in the summer/fall of 2015 and 2016</li>
                  <li>average deployment duration was &#8776;1 year</li>
                  <li>recorder depths ranged from 40 to 2000 meters</li>
               </ul>
            </div>
         </div>
      </section>

      <!-- Training Details -->
      <section class="slide" id="training-details-1">
         <h2>Training details</h2>
         <p>A few training details...</p>
         <ul>
            <li>the R-CNN was trained using four NVIDIA P100 GPUs each with 16GB of memory</li>
            <li>the batch size was set to 4 (one per GPU) &mdash; remember, batches grow within the net</li>
            <li>used stochastic gradient descent (SGD) with momentum=0.9 as an opt. routine</li>
            <li>the initial learning rate was set to 0.003 and decayed by a factor of 10 after learning plateaued</li>
         </ul>
         <div class="slide" id="training-details-2">
            <img width=90% src="media/images/example_losses.png" />
         </div>
      </section>

      <!-- Results -->
      <section class="slide" id="results-1">
         <h2>Experimental results</h2>
         <br /><br />
         <table class="mnml-table" style="font-size: 0.9em; margin-top: 2em;">
            <tr>
               <th>species</th>
               <th>label</th>
               <th>instances</th>
               <th style="border-left: solid 3px #ef8376;">AP<sub>IoU=0.5</sub></th>
               <th>mAP<sub>[.5:.95]</sub></th>
               <th style="border-left: solid 3px #ef8376;">AR<sub>IoU=0.5</sub></th>
               <th>mAR<sub>[.5:.95]</sub></th>
            </tr>
            <tr>
               <td style="text-align: center">overall</td>
               <td style="text-align: center">-</td>
               <td style="text-align: center">2813</td>
               <td style="text-align: center; border-left: solid 3px #ef8376;"><b>82.1</b></td>
               <td style="text-align: center">41.8</td>
               <td style="text-align: center; border-left: solid 3px #ef8376;"><b>91.9</td>
               <td style="text-align: center">54.8</td>
            </tr>
            <tr>
               <td style="text-align: center">blue whales</td>
               <td style="text-align: center">BW</td>
               <td style="text-align: center">487</td>
               <td style="text-align: center; border-left: solid 3px #ef8376;"><b>85.7</b></td>
               <td style="text-align: center">52.8</td>
               <td style="text-align: center; border-left: solid 3px #ef8376;"><b>96.2</b></td>
               <td style="text-align: center">70.9</td>
            </tr>
            <tr>
               <td style="text-align: center">fin whales</td>
               <td style="text-align: center">FW</td>
               <td style="text-align: center">2099</td>
               <td style="text-align: center; border-left: solid 3px #ef8376;"><b>75.3</b></td>
               <td style="text-align: center">30.8</td>
               <td style="text-align: center; border-left: solid 3px #ef8376;"><b>89.9</b></td>
               <td style="text-align: center">40.0</td>
            </tr>
            <tr>
               <td style="text-align: center">sei whales</td>
               <td style="text-align: center">SW</td>
               <td style="text-align: center">227</td>
               <td style="text-align: center; border-left: solid 3px #ef8376;"><b>85.4</b></td>
               <td style="text-align: center">41.9</td>
               <td style="text-align: center; border-left: solid 3px #ef8376;"><b>89.7</b></td>
               <td style="text-align: center">49.4</td>
            </tr>
         </table>
         <p style="font-size: 0.5em; position: absolute; bottom: 7.5%; left: 30%;">
            <b>*</b> metrics are as described in the <a href="http://cocodataset.org/#detection-eval">COCO Detection Challenge</a>
         </p>
      </section>

      <section class="slide" id="results-cont-1">
         <h2 class="section-continued">... experimental results</h2>
         <img style="width: 75%;" src="media/images/bw_examples.png"/>
      </section>

      <section class="slide" id="results-cont-2">
         <h2 class="section-continued">... experimental results</h2>
         <img style="width: 75%;" src="media/images/fw_examples.png"/>
      </section>

      <section class="slide" id="results-cont-3">
         <h2 class="section-continued">... experimental results</h2>
         <img style="width: 75%;" src="media/images/sw_examples.png"/>
      </section>

      <section class="slide" id="results-cont-4">
         <h2 class="section-continued">... experimental results</h2>
         <p style="text-align: center">R-CNN detections for a recent recording from the Gasp√© recorded in September 2019</p>
         <img style="width: 70%;" src="media/images/test_video.gif"/>
      </section>

      <!-- Future Work -->
      <section class="slide" id="future-work">
         <h2>Future work I'm doing now</h2>
         <ul>
            <li class="slide" id="future-work-li-2">
               semi-supervision for overcoming the partially labelled data problem
               <ul>
                  <li>
                     novel approach I am hoping to write up in the new year
                  </li>
                  <li>
                     benchmark against other SOTA approaches (e.g. MixUp & MixMatch)
                  </li>
               </ul>
            </li>
            <li class="slide" id="future-work-li-3">
               unsupervised learning of acoustic signatures
               <ul>
                  <li>
                     unsupervised pre-training for the backbone
                  </li>
                  <li>
                     (normalizing) flow models for acoustic data
                  </li>
               </ul>
            </li>
            <li class="slide" id="future-work-li-4">
               interpretability methods for CNNs trained on acoustic data
               <ul>
                  <li>
                     can we describe saliency maps in terms of a signal?
                  </li>
               </ul>
            </li>
         </ul>
      </section>

      <!-- Acknowledgments -->
      <section class="slide" id="thanks">
         <p style="text-align: center; padding-top: 10%">Thanks &#215; 2<sup>53</sup> to my colleagues at JASCO and Dalhousie</p>
         <ul style="display: block; text-align: center;">
            <li style="display: inline-block">
               <img style="border-radius: 50%; width: 220px; padding: 1em 2em;" src="media/images/zissou_stan.jpg"/>
               <p>Dr. Stan Matwin</p>
            </li>
            <li style="display: inline-block">
               <img style="border-radius: 50%; width: 220px; padding: 1em 2em;" src="media/images/zissou_bruce.jpg"/>
               <p>Dr. Bruce Martin</p>
            </li>
            <li style="display: inline-block">
               <img style="border-radius: 50%; width: 220px; padding: 1em 2em;" src="media/images/zissou_katie.jpg"/>
               <p>Katie Kowarski</p>
            </li>
            <li style="display: inline-block">
               <img style="border-radius: 50%; width: 220px; padding: 1em 2em;" src="media/images/zissou_briand.jpg"/>
               <p>Briand Gaudet</p>
            </li>
         </ul>
         <p style="font-size: 0.5em; position: absolute; bottom: 7.5%; left: 22.5%;">
            stills taken from "The Life Aquatic with Steve Zissou". Wes Anderson. Buena Vista Pictures, 2004
         </p>
      </section>

      <!-- The End-->
      <section class="slide" id="the-end">
         <div class="slide-content">
            <h1 style="margin-top: 20%; text-align: center;">Thank you for listening!</h1>
            <br /><br />
            <table align="center">
               <tr>
                  <td class="logo-img" style="padding-right: 40px"><img height="60" src="media/images/dallogo.png" /></td>
                  <td class="logo-img"><img height="90" src="media/images/bigdatalogo.png" /></td>
                  <td class="logo-img" style="padding-top: 20px"><img height="90" src="media/images/jascologo.png" /></td>
               </tr>
            </table>
         </div>
      </section>

   <!-- Close the deck-container -->
   </div>

   <!-- Load resources -->
   <script src="core/deck.core.js"></script>
   <script src="extensions/menu/deck.menu.js"></script>
   <script src="extensions/goto/deck.goto.js"></script>
   <script src="extensions/status/deck.status.js"></script>
   <script src="extensions/scale/deck.scale.js"></script>
   <script src="extensions/deck.events.js"></script>

   <!-- Initialize the deck -->
   <script type="text/javascript">
      $(function() {
         $.extend(true, $.deck.defaults, {
            selectors: {
               statusCurrent: '.deck-status-current',
               statusTotal: '.deck-status-total'
            },
            countNested: false
         });
         $.deck('.slide');
         $.deck('enableScale')
      });
   </script>

</body>

</html>
